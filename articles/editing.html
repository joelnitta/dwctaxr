<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Editing taxonomic databases in Darwin Core format
">
<title>Editing DWC taxon data • dwctaxon</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Editing DWC taxon data">
<meta property="og:description" content="Editing taxonomic databases in Darwin Core format
">
<meta property="og:image" content="https://joelnitta.github.io/dwctaxon/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dwctaxon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/what-is-dwc.html">What is DWC?</a>
    <a class="dropdown-item" href="../articles/editing.html">Editing DWC taxon data</a>
    <a class="dropdown-item" href="../articles/validation.html">Validating DWC taxon data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/joelnitta/dwctaxon/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Editing DWC taxon data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joelnitta/dwctaxon/blob/HEAD/vignettes/editing.Rmd" class="external-link"><code>vignettes/editing.Rmd</code></a></small>
      <div class="d-none name"><code>editing.Rmd</code></div>
    </div>

    
    
<p>dwctaxon has two major purposes, (1) editing and (2) validation of
taxonomic data in <a href="https://dwc.tdwg.org/terms/#taxon" class="external-link">Darwin
Core (DWC)</a> format. This vignette is about the former. Although you
could use dwctaxon to build a taxonomic database from scratch, it is
more likely you will be using it to modify an existing database, so we
will focus on that kind of use-case.</p>
<p>We start by loading packages needed for this vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://joelnitta.github.io/dwctaxon/">dwctaxon</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span> <span class="co"># recommended for pretty-printing of tibbles</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-data">The data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h2>
<p>dwctaxon comes with an example dataset <code>dct_filmies</code>,
taxonomic data of filmy ferns (<a href="https://en.wikipedia.org/wiki/Hymenophyllaceae" class="external-link">family
Hymenophyllaceae</a>). Let’s take a quick look at the data (you may need
to scroll to the right of the frame with the code to see all the
text):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dct_filmies</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,451 × 5</span></span></span>
<span><span class="co">#&gt;    taxonID  acceptedNameUsageID taxonomicStatus taxonRank scientificName                            </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 54115096 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes atrovirens Presl             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 54133783 54115097            synonym         species   Trichomanes crassum Copel.                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 54115097 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes crassum (Copel.) M. G. Price </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 54133784 54115098            synonym         species   Trichomanes densinervium Copel.           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 54115098 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes densinervium (Copel.) Copel. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 54133786 54115100            synonym         species   Cephalomanes curvatum (J. Sm.) V. D. Bosch</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 54133787 54115100            synonym         species   Cephalomanes javanica (Bl.) V. D. Bosch   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 54133788 54115100            synonym         species   Cephalomanes oblongifolium Presl          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 54133789 54115100            synonym         species   Cephalomanes zollingeri V. D. Bosch       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 54133790 54115100            synonym         species   Lacostea javanica (Bl.) Prantl            </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,441 more rows</span></span></span></code></pre></div>
<p>For demonstration purposes, we will just use the first five rows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filmies_small</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dct_filmies</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Although DWC taxon format includes a large number of terms
(columns)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;See &lt;code&gt;dct_terms&lt;/code&gt; for a list&lt;/p&gt;"><sup>1</sup></a>, a typical database does not use all of
them. <code>dct_filmies</code> only includes 5 columns. Their usage
should be clear to most biologists, but two columns need more
explanation. <code>taxonID</code> is a unique ID for each row (name),
and <code>acceptedNameUsageID</code> is only provided for synonyms; it
indicates the <code>taxonID</code> of the accepted name. For more
information on DWC taxon format, see
<code><a href="../articles/what-is-dwc.html">vignette("what-is-dwc")</a></code>.</p>
<p>The rest of the vignette will consist of modifying this dataset.</p>
</div>
<div class="section level2">
<h2 id="adding-rows">Adding rows<a class="anchor" aria-label="anchor" href="#adding-rows"></a>
</h2>
<div class="section level3">
<h3 id="adding-rows-by-vector">Adding rows by vector<a class="anchor" aria-label="anchor" href="#adding-rows-by-vector"></a>
</h3>
<p><code><a href="../reference/dct_add_row.html">dct_add_row()</a></code> is used to add rows. The simplest way to
do this is by specifying the new values as vectors (vectors of length 1
are recycled):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filmies_small</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/dct_add_row.html">dct_add_row</a></span><span class="op">(</span></span>
<span>    scientificName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Homo sapiens"</span>, <span class="st">"Drosophila melanogaster"</span><span class="op">)</span>,</span>
<span>    taxonomicStatus <span class="op">=</span> <span class="st">"accepted"</span>,</span>
<span>    taxonRank <span class="op">=</span> <span class="st">"species"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 6</span></span></span>
<span><span class="co">#&gt;   taxonID                          acceptedNameUsageID taxonomicStatus taxonRank scientificName                            modified         </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54115096                         <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes atrovirens Presl             <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54133783                         54115097            synonym         species   Trichomanes crassum Copel.                <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54115097                         <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes crassum (Copel.) M. G. Price <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 54133784                         54115098            synonym         species   Trichomanes densinervium Copel.           <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 54115098                         <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes densinervium (Copel.) Copel. <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> be111923a2780f4931ca7fa4ed09a1b9 <span style="color: #BB0000;">NA</span>                  accepted        species   Homo sapiens                              2023-05-02 09:25…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 5942a5b04c33f577946e4ccfbe490800 <span style="color: #BB0000;">NA</span>                  accepted        species   Drosophila melanogaster                   2023-05-02 09:25…</span></span></code></pre></div>
<p>Notice that although we did not specify <code>taxonID</code> or
<code>modified</code>, these columns are automatically filled by
default<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;code&gt;taxonID&lt;/code&gt; is filled with the &lt;a href="https://en.wikipedia.org/wiki/Hash_function" class="external-link"&gt;md5 hash&lt;/a&gt; of the
scientific name. By default, the hash is 32 characters long, so
automatically generated values of &lt;code&gt;taxonID&lt;/code&gt; should be unique
if the scientific names are unique. This can be checked by running
&lt;code&gt;&lt;a href="../reference/dct_validate.html"&gt;dct_validate()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>2</sup></a>;
they can be turned off by setting the <code>fill_taxon_id</code> and
<code>stamp_modified</code> arguments to <code>FALSE</code>.</p>
<p>The names of the new values should be valid DWC terms. You can see
the terms available with <code>dct_terms</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dct_terms</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 47 × 2</span></span></span>
<span><span class="co">#&gt;    group term               </span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> taxon taxonID            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> taxon scientificNameID   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> taxon acceptedNameUsageID</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> taxon parentNameUsageID  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> taxon originalNameUsageID</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> taxon nameAccordingToID  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> taxon namePublishedInID  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> taxon taxonConceptID     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> taxon scientificName     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> taxon acceptedNameUsage  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 37 more rows</span></span></span></code></pre></div>
<p>There are few exceptions to this requirement of using DWC terms,
however. To save on typing these rather long names, there are aliases
available for the most commonly used terms as follows:</p>
<ul>
<li>
<code>taxon_id</code> = <code>taxonID</code>
</li>
<li>
<code>sci_name</code> = <code>scientificName</code>
</li>
<li>
<code>tax_status</code> = <code>taxonomicStatus</code>
</li>
<li>
<code>usage_id</code> = <code>acceptedNameUsageID</code>
</li>
<li>
<code>usage_name</code> = <code>acceptedNameUsage</code>
</li>
</ul>
<p>So we can obtain the same results above using the aliases:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filmies_small</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/dct_add_row.html">dct_add_row</a></span><span class="op">(</span></span>
<span>    sci_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Homo sapiens"</span>, <span class="st">"Drosophila melanogaster"</span><span class="op">)</span>,</span>
<span>    tax_status <span class="op">=</span> <span class="st">"accepted"</span>,</span>
<span>    taxonRank <span class="op">=</span> <span class="st">"species"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 6</span></span></span>
<span><span class="co">#&gt;   taxonID                          acceptedNameUsageID taxonomicStatus taxonRank scientificName                            modified         </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54115096                         <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes atrovirens Presl             <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54133783                         54115097            synonym         species   Trichomanes crassum Copel.                <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54115097                         <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes crassum (Copel.) M. G. Price <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 54133784                         54115098            synonym         species   Trichomanes densinervium Copel.           <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 54115098                         <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes densinervium (Copel.) Copel. <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> be111923a2780f4931ca7fa4ed09a1b9 <span style="color: #BB0000;">NA</span>                  accepted        species   Homo sapiens                              2023-05-02 09:25…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 5942a5b04c33f577946e4ccfbe490800 <span style="color: #BB0000;">NA</span>                  accepted        species   Drosophila melanogaster                   2023-05-02 09:25…</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-rows-by-dataframe">Adding rows by dataframe<a class="anchor" aria-label="anchor" href="#adding-rows-by-dataframe"></a>
</h3>
<p>Adding rows with vectors as shown above works well if you only need
to add a small number of rows. However, this could get unwieldy if you
have a large number to add. In this case, you can instead add them via a
dataframe.</p>
<p>The dataframe should have column names matching valid DWC taxon terms
(again, usage of the shorter aliases is allowed):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's add some rows from the original dct_filmies</span></span>
<span><span class="va">to_add</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">dct_filmies</span><span class="op">)</span></span>
<span></span>
<span><span class="va">filmies_small</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/dct_add_row.html">dct_add_row</a></span><span class="op">(</span>new_dat <span class="op">=</span> <span class="va">to_add</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 6</span></span></span>
<span><span class="co">#&gt;    taxonID  acceptedNameUsageID taxonomicStatus taxonRank    scientificName                                              modified           </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 54115096 <span style="color: #BB0000;">NA</span>                  accepted        species      Cephalomanes atrovirens Presl                               <span style="color: #BB0000;">NA</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 54133783 54115097            synonym         species      Trichomanes crassum Copel.                                  <span style="color: #BB0000;">NA</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 54115097 <span style="color: #BB0000;">NA</span>                  accepted        species      Cephalomanes crassum (Copel.) M. G. Price                   <span style="color: #BB0000;">NA</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 54133784 54115098            synonym         species      Trichomanes densinervium Copel.                             <span style="color: #BB0000;">NA</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 54115098 <span style="color: #BB0000;">NA</span>                  accepted        species      Cephalomanes densinervium (Copel.) Copel.                   <span style="color: #BB0000;">NA</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 54126747 <span style="color: #BB0000;">NA</span>                  accepted        infraspecies Hymenophyllum myriocarpum var. endiviifolium (Desv.) Stolze 2023-05-02 09:25:5…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 54135528 54126748            synonym         species      Hymenophyllum nigrescens Liebm.                             2023-05-02 09:25:5…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 54135530 54126748            synonym         species      Mecodium nigricans (Presl ex Kl.) Copel.                    2023-05-02 09:25:5…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 54135531 54126748            synonym         species      Sphaerocionium nigricans Presl ex Kl.                       2023-05-02 09:25:5…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 54126748 <span style="color: #BB0000;">NA</span>                  accepted        infraspecies Hymenophyllum myriocarpum var. nigrescens (Liebm.) Stolze   2023-05-02 09:25:5…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 54126749 <span style="color: #BB0000;">NA</span>                  accepted        infraspecies Hymenophyllum trichophyllum var. buesii C. V. Morton        2023-05-02 09:25:5…</span></span></code></pre></div>
<p>Note that in this case the <code>taxonID</code> already existed in
the data to add, so it is not generated automatically.</p>
</div>
</div>
<div class="section level2">
<h2 id="modifying-rows">Modifying rows<a class="anchor" aria-label="anchor" href="#modifying-rows"></a>
</h2>
<div class="section level3">
<h3 id="identifying-rows-to-modify">Identifying rows to modify<a class="anchor" aria-label="anchor" href="#identifying-rows-to-modify"></a>
</h3>
<p><code><a href="../reference/dct_modify_row.html">dct_modify_row()</a></code> changes the values in an existing
row.</p>
<p>Here, it is helpful to reiterate the purpose of the
<code>taxonID</code> column: it is a unique identifier for each row
(taxonomic name) in the data. So we will use <code>taxonID</code> to
identify the row to change, then apply new values using other DWC terms
(again, usage of the shorter aliases is allowed).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change the status of Trichomanes crassum Copel. to "accepted"</span></span>
<span><span class="va">filmies_small</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/dct_modify_row.html">dct_modify_row</a></span><span class="op">(</span></span>
<span>    taxon_id <span class="op">=</span> <span class="st">"54133783"</span>, <span class="co"># taxonID of Trichomanes crassum Copel.</span></span>
<span>    tax_status <span class="op">=</span> <span class="st">"accepted"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   taxonID  acceptedNameUsageID taxonomicStatus taxonRank scientificName                            modified                  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54115096 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes atrovirens Presl             <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54133783 <span style="color: #BB0000;">NA</span>                  accepted        species   Trichomanes crassum Copel.                2023-05-02 09:25:51.235738</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54115097 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes crassum (Copel.) M. G. Price <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 54133784 54115098            synonym         species   Trichomanes densinervium Copel.           <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 54115098 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes densinervium (Copel.) Copel. <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>Notice there were some additional automatic changes besides just
<code>taxonomicStatus</code>. Since the new status is
<code>"accepted"</code>, dwctaxon automatically set
<code>acceptedNameUsageID</code> (which indicates the
<code>taxonID</code> of the accepted name for synonyms) to
<code>NA</code>. This behavior can be disabled by setting the
<code>clear_usage_id</code> argument to <code>FALSE</code>. We see the
<code>modified</code> field has been updated as well.</p>
<p>However, it can be difficult for humans to keep track of which
<code>taxonID</code> matches which name; typically, we think in terms of
species names, not ID numbers. For that reason, you can also use
<code>sci_name</code> (or <code>scientificName</code>) instead of
<code>taxon_id</code> to specify a row to modify<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This only works if the scientific name is unique within
the dataset&lt;/p&gt;"><sup>3</sup></a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change the status of Trichomanes crassum Copel. to "accepted"</span></span>
<span><span class="va">filmies_small</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/dct_modify_row.html">dct_modify_row</a></span><span class="op">(</span></span>
<span>    sci_name <span class="op">=</span> <span class="st">"Trichomanes crassum Copel."</span>,</span>
<span>    tax_status <span class="op">=</span> <span class="st">"accepted"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   taxonID  acceptedNameUsageID taxonomicStatus taxonRank scientificName                            modified                  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54115096 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes atrovirens Presl             <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54133783 <span style="color: #BB0000;">NA</span>                  accepted        species   Trichomanes crassum Copel.                2023-05-02 09:25:51.354911</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54115097 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes crassum (Copel.) M. G. Price <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 54133784 54115098            synonym         species   Trichomanes densinervium Copel.           <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 54115098 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes densinervium (Copel.) Copel. <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>If you provide <strong>both</strong> <code>taxon_id</code> and
<code>sci_name</code>, dwctaxon will identify the row with
<code>taxon_id</code> and apply <code>sci_name</code> as the new
scientific name:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change the name of Trichomanes crassum Copel.</span></span>
<span><span class="va">filmies_small</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/dct_modify_row.html">dct_modify_row</a></span><span class="op">(</span></span>
<span>    taxon_id <span class="op">=</span> <span class="st">"54133783"</span>, <span class="co"># taxonID of Trichomanes crassum Copel.</span></span>
<span>    sci_name <span class="op">=</span> <span class="st">"Bogus name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   taxonID  acceptedNameUsageID taxonomicStatus taxonRank scientificName                            modified                 </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54115096 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes atrovirens Presl             <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54133783 54115097            synonym         species   Bogus name                                2023-05-02 09:25:51.45764</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54115097 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes crassum (Copel.) M. G. Price <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 54133784 54115098            synonym         species   Trichomanes densinervium Copel.           <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 54115098 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes densinervium (Copel.) Copel. <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="automatic-re-mapping-of-synonyms">Automatic re-mapping of synonyms<a class="anchor" aria-label="anchor" href="#automatic-re-mapping-of-synonyms"></a>
</h3>
<p>Another convenient automated behavior of dwctaxon is the ability to
“re-map” synonyms. That is, if a previously accepted name (say, “A”) is
changed to be the synonym of another name (say, “B”), all synonyms of
“A” are also changed to be synonyms of “B”. Let’s see how this works
with the example data:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change C. densinervium to a synonym of C. crassum</span></span>
<span><span class="va">filmies_small</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/dct_modify_row.html">dct_modify_row</a></span><span class="op">(</span></span>
<span>    sci_name <span class="op">=</span> <span class="st">"Cephalomanes densinervium (Copel.) Copel."</span>,</span>
<span>    tax_status <span class="op">=</span> <span class="st">"synonym"</span>,</span>
<span>    usage_name <span class="op">=</span> <span class="st">"Cephalomanes crassum (Copel.) M. G. Price"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   taxonID  acceptedNameUsageID taxonomicStatus taxonRank scientificName                            modified                  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54115096 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes atrovirens Presl             <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54133783 54115097            synonym         species   Trichomanes crassum Copel.                <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54115097 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes crassum (Copel.) M. G. Price <span style="color: #BB0000;">NA</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 54133784 54115097            synonym         species   Trichomanes densinervium Copel.           2023-05-02 09:25:51.568832</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 54115098 54115097            synonym         species   Cephalomanes densinervium (Copel.) Copel. 2023-05-02 09:25:51.565054</span></span></code></pre></div>
<p>Notice that <strong>two</strong> names were modified even though we
only specified one; since <em>Trichomanes densinervium</em> Copel. was a
synonym of <em>Cephalomanes densinervium</em> (Copel.) Copel., it also
gets <strong>re-mapped</strong> to the accepted name <em>Cephalomanes
crassum</em> (Copel.) M. G. Price</p>
</div>
</div>
<div class="section level2">
<h2 id="filling-columns">Filling columns<a class="anchor" aria-label="anchor" href="#filling-columns"></a>
</h2>
<p>As described in <code><a href="../articles/what-is-dwc.html">vignette("what-is-dwc")</a></code>, there are
several terms in DWC that I call “term - termID” pairs, e.g.,
<code>acceptedNameUsage</code> and <code>acceptedNameUsageID</code>,
<code>parentNameUsage</code> and <code>parentNameUsageID</code>, etc.
Typically, one is an actual scientific name (e.g., for
<code>acceptedNameUsage</code>, the accepted name of a synonym), and one
is the <code>taxonID</code> of that name (e.g., for
<code>acceptedNameUsageID</code>, the <code>taxonID</code> of the
accepted name of a synonym). It is up to the manager of the database to
choose whether to use either or both of the terms in the pair.</p>
<p>This sort of data is redundant and could be prone to error if entered
manually, so dwctaxon can do it for us with <code><a href="../reference/dct_fill_col.html">dct_fill_col()</a></code>.
The easiest way to see how this works is with an example (you may need
to scroll to the right to see the new column):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fill-in the acceptedNameUsage column with scientific names</span></span>
<span><span class="va">filmies_small</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/dct_fill_col.html">dct_fill_col</a></span><span class="op">(</span></span>
<span>    fill_to <span class="op">=</span> <span class="st">"acceptedNameUsage"</span>,</span>
<span>    fill_from <span class="op">=</span> <span class="st">"scientificName"</span>,</span>
<span>    match_to <span class="op">=</span> <span class="st">"taxonID"</span>,</span>
<span>    match_from <span class="op">=</span> <span class="st">"acceptedNameUsageID"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   taxonID  acceptedNameUsageID taxonomicStatus taxonRank scientificName                            acceptedNameUsage                        </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54115096 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes atrovirens Presl             <span style="color: #BB0000;">NA</span>                                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54133783 54115097            synonym         species   Trichomanes crassum Copel.                Cephalomanes crassum (Copel.) M. G. Price</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54115097 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes crassum (Copel.) M. G. Price <span style="color: #BB0000;">NA</span>                                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 54133784 54115098            synonym         species   Trichomanes densinervium Copel.           Cephalomanes densinervium (Copel.) Copel.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 54115098 <span style="color: #BB0000;">NA</span>                  accepted        species   Cephalomanes densinervium (Copel.) Copel. <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>The meaning of the arguments <code>fill_to</code> and
<code>fill_from</code> I think are fairly clear: we are filling the
<code>acceptedNameUsage</code> column with values from
<code>scientificName</code>.</p>
<p><code>match_to</code> and <code>match_from</code> are a bit trickier;
they describe <em>how</em> to find the data for filling. Here, we are
looking up <code>acceptedNameUsage</code> by matching
<code>acceptedNameUsageID</code> (<code>match_from</code>) to
<code>taxonID</code> (<code>match_to</code>).</p>
<p>Like I said, it’s easiest to figure out <code><a href="../reference/dct_fill_col.html">dct_fill_col()</a></code>
by trying it yourself.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joel H. Nitta.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
